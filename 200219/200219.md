# 200219

## 서블릿

- 순수 서블릿: 개발자가 직접 작성
- 응용 서블릿: jsp파일을 생성하면 서버 내부에서 자동으로 생성되는 서블릿

---

# Page Directives_< %@include% >

> 여러 페이지에 공통으로 사용되는 내용을 가진 파일을
> 해당 JSP 페이지 내에 삽입하는 기능을 가진 지시어

- 메소드 사용 목적과 비슷
  반복되는 내용을 파일로 만들어 두었다가 필요한 경우에 불러옴
- 포함될 파일의 내용을 복사해서 붙여넣는 방식으로 작동
- include 사용 JSP 페이지가 컴파일 될 때
  include 된 JSP 페이지의 소스를 그대로 포함해서 컴파일됨
  두 개의 파일이 하나의 파일로 합쳐져서 변환된 후 컴파일되는 것
- 주로 조각 코드를 삽입하거나
정적인 화면을 디자인 하는데 사용됨
- JSP 페이지에 동일한 페이지를 두 번 이상 include 할 수는 없음
  include 된 페이지의 변수와 메소드는 표현식으로 반복해서 출력 가능
- 불러오는 파일의 확장자는 중요하지 않음
  어떤 확장자든 내부의 소스 코드만 불러옴

## 형식

```jsp
<%@ include file="상대 경로/파일명" %> 
```

## 예제

> IncludeTest.jsp 에서 여러 가지 파일을 include 하는 예제

### IncludeTest.jsp

> 다른 파일들을 include 하는 JSP 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h3>이 페이지는 include 지시어를 연습하기 위해 만들어졌습니다.</h3>
	<%@include file="./Included.jsp"%>
	<%=strJsp%>
	<%=getStrJsp()%>


	<%@include file="./sub/JspModule.java"%>
	<%=strJava%>
	<%=getStrJava()%>

	<%@include file="./bottom/bottom.jsp"%>
</body>
</html>
```

### Included.jsp

> IncludeTest.jsp 에서 사용할 변수와 메소드를 미리 선언해 둔 .jsp 파일

```jsp
<%!
	String strJsp = ".jsp loaded";
	String getStrJsp() {
	return strJsp;
	}
%>

<h1>Included.jsp included</h1>
```

### sub/JspModule.java

> 일반적인 Java 코드를 작성하는 파일이 아님
> 확장자는 중요하지 않고 소스 코드 내용이 중요함

```java
<%!
	String strJava = ".java loaded";
	String getStrJava() {
	return strJava;
	}
%>

<h1>JspModule.java included</h1>
```

### bottom/bottom.jsp

> html 파일의 경우 한글이 깨지기 때문에
> jsp파일로 작성한 뒤 page 디렉티브를 사용해서 인코딩을 지정해 줌

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
	
<div class="area_user">
	<div class="au_wrap">
		<h3 class="au_tit">Korean</h3>
		<ul class="au_l">
			<li class="au_item">안녕하세요</li>
			<li class="au_item">안녕?</li>
		</ul>
	</div>
	<div class="au_wrap">
		<h3 class="au_tit">English</h3>
		<ul class="au_l">
			<li class="au_item">HELLO</li>
			<li class="au_item">Hi</li>
			<li class="au_item">Hey</li>
			<li class="au_item">Bye</li>
		</ul>
	</div>
</div>
```

### 결과

![200219 MD 결과](C:\webtest\capture\200219 MD 결과.png)

---

# 내장 객체

- 스크립트릿 안에서만 사용 가능
- 스크립트릿에 내장 객체와 같은 이름의 변수를 선언할 수 없음
  선언문에서는 사용 가능하나 가급적 사용하지 않는 것이 좋음
- 서블릿 컨테이너가 해당 JSP 페이지 실행 시 자동으로 생성
  jsp가 변환된 fileName_jsp.java 파일을 열어보면 
  _jspService() 메소드 내부에 선언되어 있음

## 내장 객체 종류

| 내장 객체      | 반환값 타입                                                  | 설명                                                         |
| -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ***request***  | javax.servlet.http.httpServletRequest<br />또는 javax.servlet.ServletRequest | 웹 브라우저의 요청 정보를 저장하고 있는 객체                 |
| ***response*** | javax.servlet.http.httpServletResponse<br />또는 javax.servlet.ServletResponse | 웹 브라우저의 요청에 대한 응답 정보를 저장하는 객체          |
| ***out***      | javax.servlet.jsp.JspWriter                                  | JSP 페이지의 출력할 내용을 가지고 있는 출력 스트림 객체      |
| ***session***  | javax.servlet.http.HttpSession                               | 하나의 웹 브라우저 내에서 정보를 유지하기 위한 세션 정보를 저장하고 있는 객체 |
| *application*  | javax.servlet.ServletContext                                 | 웹 애플리케이션 Context의 정보를 담고 있는 객체              |
| *pageContext*  | javax.servlet.jsp.PageContext                                | JSP 페이지에 대한 정보를 저장하고 있는 객체                  |
| *page*         | java.lang.Object                                             | JSP 페이지를 구현한 자바 클래스 객체                         |
| *config*       | javax.servlet.ServletConfig                                  | JSP 페이지에 대한 설정 정보를 담고 있는 객체                 |
| *exception*    | java.lang.Throwable                                          | JSP 페이지에서 예외가 발생한 경우 사용하는 객체              |

*※ 자주 사용되는 내장 객체는 굵은 글씨로 표기*

 ## setAttribute() & getAttribute

> request, session, application, pageContext 내장 객체는
> 속성(attribute)값을 저장하고 읽을 수 있는 메소드 제공
>
> 속성값을 저장하고 읽을 수 있는 기능은
> JSP 페이지 및 서블릿 간 정보를 주고받을 수 있도록 함

| 메소드                                        | 설명                                                         |
| --------------------------------------------- | ------------------------------------------------------------ |
| *void setAttribute(String key, Object value)* | 해당 내장 객체의 속성값을 설정하는 메소드<br />key 속성명에 value 속성값을 지정 |
| *java.util.Enumeration getAttributeNames()*   | 해당 내장 객체의 속성명을 읽어오는 메소드<br />모든 속성의 이름을 얻어옴 |
| *Object getAttribute(String key)*             | key 속성명에 해당하는 속성값 반환                            |
| *void removeAttribute(String key)*            | key 속성명에 해당하는 속성 제거                              |

***※ 내장 객체 영역에 해당하는 범위 내에서 데이터 송수신 가능***
***request, session, application 내장 객체에 사용***

## 내장 객체 영역

> 웹 애플리케이션은 page, request, session, application 4개의 영역(scope)을 가짐
> 내장 객체의 영역은 객체 유효기간이라고도 불리며
> 객체를 누구와 공유할 것인가를 나타냄

### page 영역

- 한 번의 웹 브라우저(클라이언트)의 요청에 대해 하나의 JSP 페이지가 호출됨
- page 영역은 객체를 하나의 페이지 내에서만 공유
- pageContext 내장 객체 사용

### request 영역

- 한 번의 웹 브라우저의 요청에 대해 같은 요청을 공유하는 페이지가 대응됨
- 같은 request 영역인 경우 두 개의 페이지가 같은 요청을 공유할 수 있음
- 객체를 하나 또는 두 개의 페이지 내에서 공유 가능
- include, forward 액션 태그 사용시 request 내장 객체를 공유하게 되며
  그에 따라 같은 request 영역이 됨
- 주로 페이지 모듈화에 사용, request 내장 객체 사용

### session 영역

- 하나의 웹 브라우저당 1개의 session 객체 생성
- 같은 웹 브라우저 내에서 요청되는 페이지들은 같은 객체 공유
- 주로 회원 관리(인증)에 사용되며 session 내장 객체 사용

### application 영역

- 하나의 웹 애플리케이션(프로젝트)당 1개의 application 객체 생성
- 같은 웹 애플리케이션에 요청되는 페이지들은 같은 객체 공유
  /Project_Name 웹 애플리케이션에서는 같은 application 객체 공유
- 애플리케이션 전체에서 공유하는 객체이므로
  메모리에 부담이 갈 수 있어서 자주 사용되지는 않음
- application 내장 객체 사용

---

# Response 내장 객체

> 웹 브라우저로 응답할 응답 정보를 가지는 JSP 내장 객체

- 웹 브라우저에 보내는 응답 정보는 HttpServletResponse 객체에 있음
- JSP에서는 response 객체를 이용해서 접근
- 주로 헤더 정보 입력, 리다이렉트 등의 기능을 제공

## Response Method

| 메소드                        | 설명                                                         |
| ----------------------------- | ------------------------------------------------------------ |
| *void setHeader(name, value)* | 헤더 정보의 값을 수정하는 메소드<br />name에 해당하는 헤더 정보를 value로 수정 |
| *void setContentType(type)*   | 웹 브라우저의 요청 결과로 보일 페이지의 contentType 설정<br />page 디렉티브의 contentType 속성과 같은 역할 |
| *void sendRedirect(url)*      | 페이지를 이동시키는 메소드<br />url 페이지로 제어가 이동함<br />중간의 로직 처리를 보여줄 필요가 없을 때 사용<br/>ex) 게시글 DB 저장 후 게시글 목록 출력 |

### sendRedirect(url) 처리 과정

1. 웹 브라우저가 a.jsp 페이지 요청
2. a.jsp 페이지의 내용을 수행
3. response.sendRedirect("b.jsp");
   문장을 만나면 프로그램 제어가 b.jsp로 이동
   이 때 위의 문장을 만나기 전까지 실행된 코드 중
   출력될 값을 모두 버린 후에 b.jsp로 이동
4. b.jsp 페이지 수행
5. b.jsp 페이지를 수행한 결과를 웹 브라우저로 응답
   ***b.jsp 페이지의 내용만 처리 결과로 화면에 출력***

*※ a.jsp와 b.jsp는 데이터를 공유하지 않음*
*→ forward 액션 태그는 데이터를 공유하면서 이동 가능*
*자기 프로젝트 내의 다른 페이지로만 이동 가능하며*
*URL이 다음 페이지로 변경되지 않음*

## 예제_sendRedirect(url)

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>sendRedirect Method Practice</h1>
	<p>매개변수 URL 주소로 이동되며 해당 페이지의 내용만 응답으로 출력</p>
	<p>이 페이지에 작성한 내용은 출력되지 않으며 URL주소 역시 표출되지 않음</p>
	<%
	// 외부 사이트로도 이동 가능
	// response.sendRedirect("http://www.daum.net");
	
	// 프로젝트 내부의 다른 파일로 이동
	response.sendRedirect("../bottom/bottom.jsp");
	%>
</body>
</html>
```

### 결과

![200219 MD_Response](C:\webtest\capture\200219 MD_Response.png)

---

# Request 예제

## 예제_웹 브라우저 & 웹 서버 정보 얻어오기

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h2>
		1. 서버 도메인 이름:
		<%=request.getServerName()%></h2>
	<h2>
		2. 서버 포트 번호:
		<%=request.getServerPort()%></h2>
	<h2>
		★★3. 요청 URL 주소:
		<%=request.getRequestURL()%></h2>
	<h2>
		★★4. 요청 URI 주소:
		<%=request.getRequestURI()%></h2>
	<h2>
		★★5. 접속 ip 주소:
		<%=request.getRemoteAddr()%></h2>
	<h2>
		6. 클라이언트가 요청한 프로토콜:
		<%=request.getProtocol()%></h2>
	<h2>
		★★7. 요청 방식(GET or POST):
		<%=request.getMethod()%></h2>
</body>
</html>
```

### 결과

![200219 MD_Request](C:\webtest\capture\200219 MD_Request.png)

## 예제

> 배열로 전송되는 데이터를 다루는 예제

### input.jsp

> 입력 form에 사용자가 값을 입력하는 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>다중 선택</title>
</head>
<body>
<!-- form의 데이터를 post 방식으로 arrayPrint.jsp로 전송 -->
<form action="arrayPrint.jsp" method="post">
	이름: <input type="text" name="name" /> <br />
	주소: <input type="text" name="addr" />
    
	<fieldset>
	<legend>좋아하는 동물</legend>
	<!-- 배열로 값을 전달하기 위해서 name 속성의 값을 동일하게 지정 --> 
	<input type="checkbox" name="pet" value="dog" /> 강아지
	<input type="checkbox" name="pet" value="cat" /> 고양이
	<input type="checkbox" name="pet" value="cow" /> 송아지
	<input type="checkbox" name="pet" value="horse" /> 망아지
	</fieldset>
    
	<input type="submit" value="전송"/>
</form>
</body>
</html>
```

### arrayPrint.jsp

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<%
	request.setCharacterEncoding("utf-8");
%>
</head>
<body>
<%
	String name = request.getParameter("name");
	String addr = request.getParameter("addr");
	// name 속성의 값이 pet인 value들을 반환해서 pet[]에 저장
	String[] pet = request.getParameterValues("pet");
%>
<h3>이름: <%=name %></h3>
<h3>주소: <%=addr %></h3>
<h3>좋아하는 동물</h3>
	<!-- pet[]이 빈 배열이 아닌 경우 출력-->
	<%if(pet != null){ %>
		<%for(int i=0; i<pet.length; i++){%>
		<h4><%out.println((i+1)+". ");%><%=pet[i] %></h4>
		<% }
	// pet[]이 빈 배열인 경우 출력
	} else { %>
		<h3>좋아하는 동물이 없으시네요.</h3>
	<% } %>	
</body>
</html>
```

### 결과

![200219 MD_Request2](C:\webtest\capture\200219 MD_Request2.png)

![200219 MD_Request3](C:\webtest\capture\200219 MD_Request3.png)

---

# Out 내장 객체

> JSP 페이지가 생성한 결과를 웹 브라우저에 전송해 주는 출력 스트림

- JSP가 웹 브라우저로 전송하는 모든 정보가 out 객체를 통해서 전송됨
  모든 정보에는 JSP 스크립트 요소와 HTML, 일반 텍스트 포함
- javax.servlet.jsp.JspWriter 클래스 타입으로 JSP에서는 out 객체로 사용
- 주로 사용되는 메소드는 웹 브라우저 출력에 사용되는 **println()**
- JSP 페이지가 서블릿으로 변환될 때
  < %=문장% > 부분은 out.println(문장)으로 변환되어 실행
- JSP 페이지가 사용하는 출력 버퍼는 out 객체가 내부적으로 사용하는 버퍼

## Out Method

| 메소드                | 설명                                                         |
| --------------------- | ------------------------------------------------------------ |
| *String println(str)* | 주어진 str 값을 웹에 출력<br />줄바꿈은 적용되지 않음        |
| *void clearBuffer()*  | 현재 출력 버퍼에 저장되어 있는 내용을 웹 브라우저에 전송하지 않고 비움 |
| *void flush()*        | 현재 출력 버퍼에 저장되어 있는 내용을 웹 브라우저에 전송하고 비움 |
| *void close()*        | 현재 출력 버퍼에 저장되어 있는 내용을 웹 브라우저에 전송하고 출력 스트림을 닫음 |

---

# Action Tag 액션 태그

## Action Tag 개요

- JSP 페이지를 이루는 요소 중 하나
- 페이지를 이동시키거나 외부 파일을 불러오는 등의 기능을 가짐
- 액션 태그는 XML 문법을 따르기 때문에
  단독 태그의 경우에도 반드시 종료 태그를 포함해야 함
  1. 바디가 있는 경우: 시작 태그와 종료 태그의 쌍으로 이루어짐
     < jsp:include page="a.jsp" />< jsp:param ~ />< /jsp:include >
  2. 바디가 없는 경우: 시작 태그에 종료 태그가 포함됨
     < jsp:include/ >

| 액션 태그명   | 액션 태그           | 설명                                                   |
| ------------- | ------------------- | ------------------------------------------------------ |
| *include*     | < jsp:include >     | 다른 페이지의 실행 결과를 현재 패에지에 포함할 때 사용 |
| *forward*     | < jsp:forward >     | 웹 페이지 간 제어를 이동시킬 때 사용                   |
| *useBean*     | < jsp:useBean >     | 자바빈을 JSP 페이지에서 쓸 때 사용                     |
| *setProperty* | < jsp:setProperty > | 프로퍼티의 값을 세팅할 때 사용                         |
| *getProperty* | < jsp:getProperty > | 프로퍼티의 값을 얻어낼 때 사용                         |
| *plug-in*     | < jsp:plug-in >     | 웹 브라우저에서 자바 애플릿을 실행시킬 때 사용         |

*※ plug-in 액션 태그는 거의 사용되지 않음*

---

# include 액션 태그

> JSP 페이지의 모듈화에 사용되는 액션 태그

- 다른 페이지의 처리 결과만을 현재 페이지에 포함
- HTML, JSP, Servlet 페이지 모두 포함 가능
- 템플릿 페이지 작성시 사용(디자인과 관련)
  ↔ include 디렉티브는 조각 코드 삽입 시 사용(변수, 메소드 선언)
- 동적으로 변경된 내용을 특정한 위치에 삽입

## 기본 형식

```jsp
<jsp:include page="포함 페이지" flush="boolean"/>
```

### page 속성

- 속성의 값은 현재 페이지에 결과가 포함될 페이지명
- 생략 불가능한 필수 속성
- 페이지명은 상대 경로 또는 절대 경로 사용
- 표현식 사용 가능
  ↔ include 디렉티브는 표현식 사용 불가

### flush 속성

- JSP 페이지는 출력할 내용을 버퍼(8kb)에 저장하는데
  포함될 페이지로 제어가 이동할 때 버퍼의 처리 방식을 속성 값으로 지정
- true: 현재 페이지가 버퍼에 저장한 내용을 웹 브라우저에 출력하고 버퍼를 비움
- false: 결과를 합쳐서 출력하기 전까지 버퍼에 출력 내용을 저장

## include 액션 태그 처리 과정

1. 웹 브라우저가 a.jsp 페이지를 서버에 요청
2. 서버가 a.jsp 처리, 페이지 내부의 출력 내용을 버퍼에 저장하는 등의 작업을 함
3. include 액션 태그를 만나면 작업을 멈추고 b.jsp로 프로그램 제어를 이동시킴
4. b.jsp 페이지 처리, 해당 페이지 내의 출력 내용을 출력 버퍼에 저장
5. b.jsp 페이지의 처리가 끝나면 다시 a.jsp 페이지로 프로그램 제어가 이동
   이동 위치는 include 액션 태그의 다음 행
6. a.jsp 페이지의 나머지 부분을 처리, 출력 내용을 버퍼에 저장
7. 출력 버퍼의 내용을 웹 브라우저로 응답

*※ include 액션 태그는 request 내장 객체를 공유하기 때문에*
*a.jsp와 b.jsp는 동일한 request 객체를 사용하게 됨* 

## param 액션 태그

> include 액션 태그의 바디에 사용하는 액션 태그
> 포함되는 JSP 페이지에 값을 전달할 때 사용

### 기본 형식

```jsp
<jsp:include ~>
	<jsp:param name="파라미터 이름" value="파라미터 값"/>
    <jsp:param name="파라미터 이름" value="<%=val%>"/>
</jsp:include>
```

- name 속성: 포함되는 JSP 페이지에 전달할 파라미터 이름 표시
- value 속성: 전달할 파라미터 값 지정, value 값으로 표현식 사용 가능

## 예제

> form.jsp에서 입력한 데이터를 include.jsp에서 전달 받아서
> sub.jsp에서 처리한 후 결과를 include.jsp에 포함해서 출력하는 예제

### form.jsp

> 입력을 받는 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<form action="include.jsp" method="post">
	이름: <input type="text" name="name" /> 
	<input type="submit" value="전송" />
</form>

</body>
</html>
```

### include.jsp

> include 액션 태그를 사용한 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
    
<!-- 한글이 깨지지 않도록 처리 -->
<%
	request.setCharacterEncoding("utf-8");
%>
    
</head>
<body>
	<h2>포함을 하는 페이지</h2>

	<!-- include 액션 태그, sub.jsp에서 실행한 결과 삽입 -->
	<jsp:include page="sub.jsp" flush="false" /><br/>

	나머지는 sub.jsp가 알아서 해줄거랍니다.
</body>
</html>
```

### sub.jsp

> include 액션 태그에 의해 include.jsp에 포함될 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<!-- 전송된 데이터를 변수에 저장 -->
	<%
		String name = request.getParameter("name");
	%>

	<!-- 출력 -->
	<b><%=name%>님 잘 오셨습니다.</b>
</body>
</html>
```

### 결과

![200219 MD_include](C:\webtest\capture\200219 MD_include.png)

*※ URL에 include.jsp의 주소가 출력됨*

---

# forward 액션 태그

> JSP 페이지의 프로그램 제어를 이동할 때 사용

- 페이지의 흐름을 제어함
- JSP 페이지 내에서 foward 액션 태그를 만나면
  그전까지 출력 버퍼에 저장되어 있던 내용을 제거한 후 지정 페이지로 이동
- 데이터를 공유하면서 페이지를 이동하기 때문에
  forward 액션 태그가 있는 페이지의 URL 주소에서 다른 페이지의 결과를 출력
- 모델 2에서는 컨트롤러가 forward 액션 태그와 같은 역할을 함
- 사용자가 입력한 값에 따라 접속하는 페이지가 다른 경우에 사용하면 좋음

## 기본 형식

```jsp
<jsp:forward page="이동 페이지명"/>
```

- page 속성의 값으로는 이동할 페이지 기술
- 상대 경로, 절대 경로, 표현식으로 지정 가능

*※ page 속성은 include 액션 태그와 동일함*

## forward 액션 태그 처리 과정

1. 웹 브라우저에서 웹 서버로 a.jsp 페이지 요청
2. 요청된 a.jsp 페이지 수행
3. forward 액션 태그를 만나면 출력 버퍼의 내용을 제거하고
   프로그램 제어를 b.jsp로 이동(포워딩)시킴
4. b.jsp 페이지 수행
5. b.jsp 페이지를 수행한 결과를 웹 브라우저에 응답

*※ include 액션 태그와 마찬가지로 forward 액션 태그에 의해*
*연결된 페이지 간에는 동일한 request 객체를 공유함*

## param 액션 태그

> forward 액션 태그의 바디에 사용하는 액션 태그
> 프로그램 제어가 이동할 JSP 페이지에 값을 전달할 때 사용

### 기본 형식

```jsp
<jsp:forward ~>
	<jsp:param name="파라미터 이름" value="파라미터 값"/>
    <jsp:param name="파라미터 이름" value="<%=val%>"/>
</jsp:forward>
```

- name 속성: 프로그램 제어가 이동할 JSP 페이지에 전달할 파라미터 이름 표시
- value 속성: 전달할 파라미터 값 지정, value 값으로 표현식 사용 가능

*※ include 액션 태그와 형식 및 사용법이 동일함*

## 예제

> ① forward.jsp 페이지에서 데이터를 입력받은 뒤
> move.jsp 페이지에서 forward 액션 태그로 프로그램 흐름 제어
>
> ② move.jsp 페이지에서 request 객체의 속성에 데이터를 저장해서
> a.jsp와 b.jsp에서 해당 데이터를 공유

### forward.jsp

> 데이터를 입력 받는 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<form action="move.jsp" method="post">
	이동할 페이지명: <input type="text" name="move" /> 
	<input type="submit" value="전송" />
</form>

</body>
</html>
```

### move.jsp

> forward 액션 태그를 사용해서 프로그램 제어를 포워딩하는 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8" import="java.util.Date"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>move.jsp</title>
</head>
<body>
	<h2>요청을 판단해서 올바른 요청인 경우에 페이지를 이동시킴</h2>
	<%
		// a.jsp에 전달할 변수
		int su = 100;
    
    	// request 객체의 "total" 속성에 su 값 저장
		request.setAttribute("total", su);

		// b.jsp에 전달할 변수
		Date d = new Date();
    
    	// request 객체의 "cal" 속성에 d 값 저장
		request.setAttribute("cal", d);

		// forward.jsp에서 데이터를 받아옴
		String move = request.getParameter("move");
		move += ".jsp";
		System.out.println(move);

		// 이동할 페이지가 있는 경우 페이지 이동
		if (move.equals("a.jsp")) {
	%>
	<!-- forward 액션 태그, 프로그램 제어를 a.jsp로 이동시킴 -->
	<jsp:forward page="a.jsp" />
	<%
		} else if (move.equals("b.jsp")) {
	%>
	<!-- forward 액션 태그, 프로그램 제어를 b.jsp로 이동시킴 -->
	<jsp:forward page="b.jsp" />
	<%
		} else {
	%>
	<!-- 잘못된 페이지 요청인 경우 알림을 띄우고 forward.jsp로 이동시킴 -->
	<script>
		alert("정상적인 페이지를 입력해주세요!!");
		location.href("forward.jsp");
	</script>
	<%
		}
	%>
</body>
</html>
```

### a.jsp

> move.jsp에 의해 프로그램 제어가 이동될 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>a.jsp</title>
</head>
<body bgcolor="yellow">
<%
    // request 객체의 total 속성 값을 가져오면서 int로 형 변환
	int su = (int)request.getAttribute("total");
%>
	<h1>a.jsp 페이지입니다.</h1>
    
    <!-- su 값 출력 -->
	<h1>su값: <%=su %></h1>
</body>
</html>
```

### b.jsp

> move.jsp에 의해 프로그램 제어가 이동될 페이지

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8" import="java.util.Date"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>b.jsp</title>
</head>
<body bgcolor="red">
	<h1>b.jsp 페이지입니다.</h1>

	<!-- request 객체의 cal 속성 값을 바로 출력
	표현식으로 바로 출력하는 경우에는 형 변환할 필요 없음 -->
	<h2>d의 값: <%=request.getAttribute("cal")%></h2>
</body>
</html>
```

### 결과

![200219 MD_forward1](C:\webtest\capture\200219 MD_forward1.png)

![200219 MD_forward2](C:\webtest\capture\200219 MD_forward2.png)

![200219 MD_forward3](C:\webtest\capture\200219 MD_forward3.png)

*※ URL의 페이지 경로가 모두 forward.jsp로 표시됨*